<?xml version="1.0"?>
<!--
/**
 *
 * Adyen Payment module (https://www.adyen.com/)
 *
 * Copyright (c) 2023 Adyen N.V. (https://www.adyen.com/)
 * See LICENSE.txt for license details.
 *
 * Author: Adyen <magento@adyen.com>
 */
-->
<include xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="urn:magento:module:Magento_Config:etc/system_include.xsd">
    <group id="adyen_initial_setup" translate="label" type="text" sortOrder="200" showInDefault="1" showInWebsite="1"
           showInStore="1">
        <fieldset_css>adyen_required_config_settings</fieldset_css>
        <label><![CDATA[Initial Setup]]></label>
        <comment>
            <![CDATA[<p>Start by connecting your Adyen Customer Area to the Adobe Commerce plugin.</p>]]>
        </comment>
        <frontend_model>Magento\Config\Block\System\Config\Form\Fieldset</frontend_model>
        <field id="configuration_mode" translate="label" type="select" sortOrder="5" showInDefault="1" showInWebsite="1"
               showInStore="1">
            <label>Configuration Mode</label>
            <source_model>Adyen\Payment\Model\Config\Source\ConfigurationModes</source_model>
            <config_path>payment/adyen_abstract/configuration_mode</config_path>
            <backend_model>Adyen\Payment\Model\Config\Backend\AutoConfiguration</backend_model>
            <tooltip>
                <![CDATA[Choose <strong>Automated</strong> if you want required settings to be configured for you automatically by using your API key, select <strong>Manual</strong> to configure all credentials manually.]]>
            </tooltip>
        </field>
        <field id="demo_mode" translate="label" type="select" sortOrder="10" showInDefault="1" showInWebsite="1"
               showInStore="1">
            <label>Environment</label>
            <source_model>Adyen\Payment\Model\Config\Source\DemoMode</source_model>
            <config_path>payment/adyen_abstract/demo_mode</config_path>
            <tooltip>
                <![CDATA[Select the environment for transactions. The <strong>Test</strong> environment is for testing and needs to be reconfigured to <strong>Live</strong> to process real payments.]]>
            </tooltip>
        </field>
        <field id="api_key_test" translate="label" type="obscure" sortOrder="20" showInDefault="1" showInWebsite="1"
               showInStore="1">
            <depends>
                <field id="demo_mode">1</field>
            </depends>
            <label>Test API key</label>
            <tooltip>
                <![CDATA[This is the API key that you generated in the test Customer Area > <strong>Developers</strong> > <strong>API credentials</strong>.]]>
            </tooltip>
            <backend_model>Magento\Config\Model\Config\Backend\Encrypted</backend_model>
            <config_path>payment/adyen_abstract/api_key_test</config_path>
            <comment model="Adyen\Payment\Model\Comment\ApiKeyEnding"/>
        </field>
        <field id="api_key_live" translate="label" type="obscure" sortOrder="20" showInDefault="1" showInWebsite="1"
               showInStore="1">
            <depends>
                <field id="demo_mode">0</field>
            </depends>
            <label>Live API key</label>
            <comment>You can find your API key for Live in your test Customer Area.
            </comment>
            <backend_model>Magento\Config\Model\Config\Backend\Encrypted</backend_model>
            <config_path>payment/adyen_abstract/api_key_live</config_path>
            <comment model="Adyen\Payment\Model\Comment\ApiKeyEnding"/>
            <tooltip>
                <![CDATA[This is the API key that you generated in the live Customer Area > <strong>Developers</strong> > <strong>API credentials</strong>.]]>
            </tooltip>
        </field>
        <field id="client_key_test" translate="label" type="text" sortOrder="30" showInDefault="1" showInWebsite="1"
               showInStore="1">
            <depends>
                <field id="demo_mode">1</field>
                <field id="configuration_mode">manual</field>
            </depends>
            <label>Test client key</label>
            <tooltip>
                <![CDATA[The client key you generated in your test Customer Area > <strong>Developers</strong> > <strong>API credentials</strong>.]]>
            </tooltip>
            <config_path>payment/adyen_abstract/client_key_test</config_path>
        </field>
        <field id="client_key_live" translate="label" type="text" sortOrder="30" showInDefault="1" showInWebsite="1"
               showInStore="1">
            <depends>
                <field id="demo_mode">0</field>
                <field id="configuration_mode">manual</field>
            </depends>
            <label>Live client key</label>
            <![CDATA[The client key you generated in your live Customer Area > <strong>Developers</strong> > <strong>API credentials</strong>.]]>
            <config_path>payment/adyen_abstract/client_key_live</config_path>
        </field>
        <field id="merchant_account_manual" translate="label" type="text" sortOrder="40" showInDefault="1" showInWebsite="1"
               showInStore="1">
            <label>Merchant account</label>
            <depends>
                <field id="configuration_mode">manual</field>
            </depends>
            <config_path>payment/adyen_abstract/merchant_account</config_path>
            <tooltip>
                <![CDATA[Merchant account is a sub-account under your company account that represents your business entity within Adyen.]]>
            </tooltip>
        </field>
        <field id="merchant_account_auto" translate="label" type="select" sortOrder="40" showInDefault="1" showInWebsite="1"
               showInStore="1">
            <label>Merchant account</label>
            <depends>
                <!-- To keep this field hidden by default for both auto and manual configuration modes, -->
                <!-- we set a non-existent configuration mode here. -->
                <field id="configuration_mode">xxx</field>
            </depends>
            <config_path>payment/adyen_abstract/merchant_account</config_path>
            <source_model>Adyen\Payment\Model\Config\Source\MerchantAccounts</source_model>
            <tooltip>
                <![CDATA[Merchant account is a sub-account under your company account that represents your business entity within Adyen.]]>
            </tooltip>
        </field>
        <field id="live_endpoint_url_prefix" translate="label" type="text" sortOrder="50" showInDefault="1"
               showInWebsite="1" showInStore="0">
            <label>Live endpoint prefix</label>
            <depends>
                <field id="demo_mode">0</field>
                <field id="configuration_mode">manual</field>
            </depends>
            <tooltip>
                <![CDATA[This unique prefix is part of your live endpoint URLs and is specific to your company account.]]>
            </tooltip>
            <comment>
                <![CDATA[Provide your unique Live URL prefix: <strong>[random]-[company name]</strong>. Find it in your Customer Area under <strong>Developers</strong> > <strong>API URLs</strong>. For more information, please check <a href="https://docs.adyen.com/developers/development-resources/live-endpoints#checkoutendpoints">  our documentation</a>.]]>
            </comment>
            <config_path>payment/adyen_abstract/live_endpoint_url_prefix</config_path>
        </field>
        <field id="create_new_webhook" translate="label" type="radios" sortOrder="60" showInDefault="1"
               showInWebsite="1" showInStore="0">
            <label>Do you want to use your existing Adyen webhook?</label>
            <depends>
                <!-- To keep this field hidden by default for both auto and manual configuration modes, -->
                <!-- we set a non-existent configuration mode here. -->
                <field id="configuration_mode">xxx</field>
            </depends>
            <source_model>Adyen\Payment\Model\Config\Source\AutoCreateNewWebhook</source_model>
            <config_path>payment/adyen_abstract/create_new_webhook</config_path>
        </field>
        <field id="notification_username" translate="label" type="text" sortOrder="70" showInDefault="1"
               showInWebsite="1" showInStore="1">
            <label>Webhook username</label>
            <depends>
                <field id="configuration_mode">manual</field>
            </depends>
            <tooltip>
                <![CDATA[The webhook username you created in your Customer Area > <strong>Developers</strong> > <strong>Webhooks</strong> to authenticate webhook requests.]]>
            </tooltip>
            <comment>
                <![CDATA[This username must match the username you created in the Customer Area.]]>
            </comment>
            <config_path>payment/adyen_abstract/notification_username</config_path>
            <backend_model>Adyen\Payment\Model\Config\Backend\WebhookCredentials</backend_model>
        </field>
        <field id="notification_password" translate="label" type="obscure" sortOrder="80" showInDefault="1"
               showInWebsite="1" showInStore="1">
            <label>Webhook password</label>
            <depends>
                <field id="configuration_mode">manual</field>
            </depends>
            <backend_model>Magento\Config\Model\Config\Backend\Encrypted</backend_model>
            <config_path>payment/adyen_abstract/notification_password</config_path>
            <tooltip>
                <![CDATA[The webhook password you created in your Customer Area > <strong>Developers</strong> > <strong>Webhooks</strong> to authenticate webhook requests.]]>
            </tooltip>
            <comment>
                <![CDATA[This password must match the password you created in the Customer Area.]]>
            </comment>

        </field>
        <field id="notification_hmac_key_test" translate="label" type="obscure" sortOrder="90" showInDefault="1"
               showInWebsite="1" showInStore="1">
            <label>Test HMAC key</label>
            <depends>
                <field id="demo_mode">1</field>
                <field id="configuration_mode">manual</field>
            </depends>
            <backend_model>Magento\Config\Model\Config\Backend\Encrypted</backend_model>
            <config_path>payment/adyen_abstract/notification_hmac_key_test</config_path>
            <tooltip>
                <![CDATA[
                The <a target ="_blank" href="https://docs.adyen.com/development-resources/webhooks/secure-webhooks/verify-hmac-signatures">HMAC  key</a> you generated in your test Customer Area to secure your webhooks.
                ]]>
            </tooltip>
        </field>
        <field id="notification_hmac_key_live" translate="label" type="obscure" sortOrder="100" showInDefault="1"
               showInWebsite="1" showInStore="1">
            <label>Live HMAC key</label>
            <depends>
                <field id="demo_mode">0</field>
                <field id="configuration_mode">manual</field>
            </depends>
            <backend_model>Magento\Config\Model\Config\Backend\Encrypted</backend_model>
            <config_path>payment/adyen_abstract/notification_hmac_key_live</config_path>
            <tooltip>
                <![CDATA[
                The <a target ="_blank" href="https://docs.adyen.com/development-resources/webhooks/secure-webhooks/verify-hmac-signatures">HMAC  key</a> you generated in your live Customer Area to secure your webhooks.
                ]]>
            </tooltip>
        </field>
        <field id="checkout_frontend_region" translate="label" type="select" sortOrder="110" showInDefault="1"
               showInWebsite="1" showInStore="0">
            <label>Front end resources region</label>
            <depends>
                <field id="configuration_mode">manual</field>
            </depends>
            <source_model>Adyen\Payment\Model\Config\Source\CheckoutFrontendRegion</source_model>
            <config_path>payment/adyen_abstract/checkout_frontend_region</config_path>
            <tooltip>
                <![CDATA[Select the region closest to your shoppers. This region must match the region of your <a target="_blank" href="https://docs.adyen.com/development-resources/live-endpoints#view-your-live-endpoints>live endpoint URL prefix</a>.]]>
            </tooltip>
        </field>
        <field id="charged_currency" translate="label" type="hidden" sortOrder="120" showInDefault="1" showInWebsite="1"
               showInStore="1">
            <label>Charged currency</label>
            <depends>
                <field id="configuration_mode">manual</field>
            </depends>
            <comment>
                <![CDATA[Currency to use for processing payments. This setting is hidden to ensure processing of payments in the expected currency, you can only change it outside of the user interface.<br><ul>Display currency(default): the store view or display currency.</li><li>Global/Website currency : The base currency is used. Depending on how Adobe Commerce is configured, this will be either the Global or the Website currency.</li></ul>]]></comment>
            <source_model>Adyen\Payment\Model\Config\Source\ChargedCurrency</source_model>
            <config_path>payment/adyen_abstract/charged_currency</config_path>
        </field>
        <field id="has_platform_integrator" translate="label" type="select" sortOrder="130" showInDefault="1">
            <label>Managed by a system integrator</label>
            <depends>
                <field id="configuration_mode">manual</field>
            </depends>
            <source_model>Magento\Config\Model\Config\Source\Yesno</source_model>
            <backend_model>Adyen\Payment\Model\Config\Backend\PlatformIntegrator</backend_model>
            <config_path>payment/adyen_abstract/has_platform_integrator</config_path>
            <tooltip>Select 'Yes' if you are a service partner that builds or implements this integration on behalf of the merchant.</tooltip>
        </field>
        <field id="platform_integrator" translate="label" type="text" sortOrder="140" showInDefault="1">
            <label>Name of the system integrator</label>
            <validate>required-entry</validate>
            <depends>
                <field id="has_platform_integrator">1</field>
            </depends>
            <tooltip>Enter the name of the service partner for partner tracking and reporting.</tooltip>
            <config_path>payment/adyen_abstract/platform_integrator</config_path>
        </field>
        <field id="configuration_wizard" translate="label" type="button" sortOrder="150" showInDefault="1" showInWebsite="1" showInStore="1">
            <depends>
                <field id="configuration_mode">auto</field>
            </depends>
            <frontend_model>Adyen\Payment\Model\Config\Adminhtml\ConfigurationWizard</frontend_model>
        </field>
        <field id="webhook_test" translate="label" type="button" sortOrder="160" showInDefault="1" showInWebsite="1" showInStore="1">
            <frontend_model>Adyen\Payment\Model\Config\Adminhtml\WebhookTest</frontend_model>
        </field>
    </group>
</include>
