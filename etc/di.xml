<?xml version="1.0"?>
<!--
/**
 *                       ######
 *                       ######
 * ############    ####( ######  #####. ######  ############   ############
 * #############  #####( ######  #####. ######  #############  #############
 *        ######  #####( ######  #####. ######  #####  ######  #####  ######
 * ###### ######  #####( ######  #####. ######  #####  #####   #####  ######
 * ###### ######  #####( ######  #####. ######  #####          #####  ######
 * #############  #############  #############  #############  #####  ######
 *  ############   ############  #############   ############  #####  ######
 *                                      ######
 *                               #############
 *                               ############
 *
 * Adyen Payment module (https://www.adyen.com/)
 *
 * Copyright (c) 2015 Adyen BV (https://www.adyen.com/)
 * See LICENSE.txt for license details.
 *
 * Author: Adyen <magento@adyen.com>
 */
-->
<config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="urn:magento:framework:ObjectManager/etc/config.xsd">

    <!-- Payment Method Facade configuration -->
    <virtualType name="AdyenPaymentGenericFacade" type="Magento\Payment\Model\Method\Adapter">
        <arguments>
            <argument name="code" xsi:type="const">Adyen\Payment\Model\Ui\AdyenGenericConfigProvider::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Adyen\Payment\Block\Form\Cc</argument>
            <argument name="infoBlockType" xsi:type="string">Adyen\Payment\Block\Info\Cc</argument>
            <argument name="valueHandlerPool" xsi:type="object">AdyenPaymentGenericValueHandlerPool</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentCcFacade" type="Magento\Payment\Model\Method\Adapter">
        <arguments>
            <argument name="code" xsi:type="const">Adyen\Payment\Model\Ui\AdyenCcConfigProvider::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Adyen\Payment\Block\Form\Cc</argument>
            <argument name="infoBlockType" xsi:type="string">Adyen\Payment\Block\Info\Cc</argument>
            <argument name="valueHandlerPool" xsi:type="object">AdyenPaymentCcValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">AdyenPaymentCcValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">AdyenPaymentCcCommandPool</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentOneclickFacade" type="Adyen\Payment\Model\Method\Adapter">
        <arguments>
            <argument name="code" xsi:type="const">Adyen\Payment\Model\Ui\AdyenOneclickConfigProvider::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Adyen\Payment\Block\Form\Oneclick</argument>
            <argument name="infoBlockType" xsi:type="string">Adyen\Payment\Block\Info\Oneclick</argument>
            <argument name="valueHandlerPool" xsi:type="object">AdyenPaymentOneclickValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">AdyenPaymentOneclickValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">AdyenPaymentOneclickCommandPool</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentHppFacade" type="Magento\Payment\Model\Method\Adapter">
        <arguments>
            <argument name="code" xsi:type="const">Adyen\Payment\Model\Ui\AdyenHppConfigProvider::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Adyen\Payment\Block\Form\Hpp</argument>
            <argument name="infoBlockType" xsi:type="string">Adyen\Payment\Block\Info\Hpp</argument>
            <argument name="valueHandlerPool" xsi:type="object">AdyenPaymentHppValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">AdyenPaymentHppValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">AdyenPaymentHppCommandPool</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentSepaFacade" type="Magento\Payment\Model\Method\Adapter">
        <arguments>
            <argument name="code" xsi:type="const">Adyen\Payment\Model\Ui\AdyenSepaConfigProvider::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Adyen\Payment\Block\Form\Sepa</argument>
            <argument name="infoBlockType" xsi:type="string">Adyen\Payment\Block\Info\Sepa</argument>
            <argument name="valueHandlerPool" xsi:type="object">AdyenPaymentSepaValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">AdyenPaymentSepaValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">AdyenPaymentSepaCommandPool</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentBoletoFacade" type="Magento\Payment\Model\Method\Adapter">
        <arguments>
            <argument name="code" xsi:type="const">Adyen\Payment\Model\Ui\AdyenBoletoConfigProvider::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Adyen\Payment\Block\Form\Boleto</argument>
            <argument name="infoBlockType" xsi:type="string">Adyen\Payment\Block\Info\Boleto</argument>
            <argument name="valueHandlerPool" xsi:type="object">AdyenPaymentBoletoValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">AdyenPaymentBoletoValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">AdyenPaymentBoletoCommandPool</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentPosFacade" type="Magento\Payment\Model\Method\Adapter">
        <arguments>
            <argument name="code" xsi:type="const">Adyen\Payment\Model\Ui\AdyenPosConfigProvider::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Adyen\Payment\Block\Form\Pos</argument>
            <argument name="infoBlockType" xsi:type="string">Adyen\Payment\Block\Info\Pos</argument>
            <argument name="valueHandlerPool" xsi:type="object">AdyenPaymentPosValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">AdyenPaymentPosValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">AdyenPaymentPosCommandPool</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentPayByMailFacade" type="Magento\Payment\Model\Method\Adapter">
        <arguments>
            <argument name="code" xsi:type="const">Adyen\Payment\Model\Ui\AdyenPayByMailConfigProvider::CODE</argument>
            <argument name="formBlockType" xsi:type="string">Adyen\Payment\Block\Form\PayByMail</argument>
            <argument name="infoBlockType" xsi:type="string">Adyen\Payment\Block\Info\PayByMail</argument>
            <argument name="valueHandlerPool" xsi:type="object">AdyenPaymentPayByMailValueHandlerPool</argument>
            <argument name="validatorPool" xsi:type="object">AdyenPaymentPayByMailValidatorPool</argument>
            <argument name="commandPool" xsi:type="object">AdyenPaymentPayByMailCommandPool</argument>
        </arguments>
    </virtualType>

    <!-- Value handlers infrastructure -->
    <virtualType name="AdyenPaymentGenericValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AdyenPaymentGenericConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentGenericConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">AdyenPaymentGenericConfig</argument>
        </arguments>
    </virtualType>


    <virtualType name="AdyenPaymentCcValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AdyenPaymentCcConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentCcConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">AdyenPaymentCcConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentOneclickValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AdyenPaymentOneclickConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentOneclickConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">AdyenPaymentOneclickConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentHppValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AdyenPaymentHppConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentHppConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">AdyenPaymentHppConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentSepaValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AdyenPaymentSepaConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentSepaConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">AdyenPaymentSepaConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentBoletoValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AdyenPaymentBoletoConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentBoletoConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">AdyenPaymentBoletoConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentPosValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AdyenPaymentPosConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentPosConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">AdyenPaymentPosConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentPayByMailValueHandlerPool" type="Magento\Payment\Gateway\Config\ValueHandlerPool">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="default" xsi:type="string">AdyenPaymentPayByMailConfigValueHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentPayByMailConfigValueHandler" type="Magento\Payment\Gateway\Config\ConfigValueHandler">
        <arguments>
            <argument name="configInterface" xsi:type="object">AdyenPaymentPayByMailConfig</argument>
        </arguments>
    </virtualType>

    <!-- Configuration reader -->
    <virtualType name="AdyenPaymentGenericConfig" type="Magento\Payment\Gateway\Config\Config">
        <arguments>
            <argument name="methodCode" xsi:type="const">Adyen\Payment\Model\Ui\AdyenGenericConfigProvider::CODE</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentCcConfig" type="Magento\Payment\Gateway\Config\Config">
        <arguments>
            <argument name="methodCode" xsi:type="const">Adyen\Payment\Model\Ui\AdyenCcConfigProvider::CODE</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentOneclickConfig" type="Magento\Payment\Gateway\Config\Config">
        <arguments>
            <argument name="methodCode" xsi:type="const">Adyen\Payment\Model\Ui\AdyenOneclickConfigProvider::CODE</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentHppConfig" type="Magento\Payment\Gateway\Config\Config">
        <arguments>
            <argument name="methodCode" xsi:type="const">Adyen\Payment\Model\Ui\AdyenHppConfigProvider::CODE</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentSepaConfig" type="Magento\Payment\Gateway\Config\Config">
        <arguments>
            <argument name="methodCode" xsi:type="const">Adyen\Payment\Model\Ui\AdyenSepaConfigProvider::CODE</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentBoletoConfig" type="Magento\Payment\Gateway\Config\Config">
        <arguments>
            <argument name="methodCode" xsi:type="const">Adyen\Payment\Model\Ui\AdyenBoletoConfigProvider::CODE</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentPosConfig" type="Magento\Payment\Gateway\Config\Config">
        <arguments>
            <argument name="methodCode" xsi:type="const">Adyen\Payment\Model\Ui\AdyenPosConfigProvider::CODE</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentPayByMailConfig" type="Magento\Payment\Gateway\Config\Config">
        <arguments>
            <argument name="methodCode" xsi:type="const">Adyen\Payment\Model\Ui\AdyenPayByMailConfigProvider::CODE</argument>
        </arguments>
    </virtualType>

    <!-- Commands infrastructure -->
    <virtualType name="AdyenPaymentCcCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="authorize" xsi:type="string">AdyenPaymentCcAuthorizeCommand</item>
                <item name="authorize_3d" xsi:type="string">AdyenPaymentAuthorize3DCommand</item>
                <item name="capture" xsi:type="string">AdyenPaymentCaptureCommand</item>
                <item name="void" xsi:type="string">AdyenPaymentCancelCommand</item>
                <item name="refund" xsi:type="string">AdyenPaymentRefundCommand</item>
                <item name="cancel" xsi:type="string">AdyenPaymentCancelCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentOneclickCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="authorize" xsi:type="string">AdyenPaymentOneclickAuthorizeCommand</item>
                <item name="authorize_3d" xsi:type="string">AdyenPaymentAuthorize3DCommand</item>
                <item name="capture" xsi:type="string">AdyenPaymentCaptureCommand</item>
                <item name="void" xsi:type="string">AdyenPaymentCancelCommand</item>
                <item name="refund" xsi:type="string">AdyenPaymentRefundCommand</item>
                <item name="cancel" xsi:type="string">AdyenPaymentCancelCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentHppCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="initialize" xsi:type="string">Adyen\Payment\Gateway\Command\HppCommand</item>
                <item name="capture" xsi:type="string">AdyenPaymentCaptureCommand</item>
                <item name="void" xsi:type="string">AdyenPaymentCancelCommand</item>
                <item name="refund" xsi:type="string">AdyenPaymentRefundCommand</item>
                <item name="cancel" xsi:type="string">AdyenPaymentCancelCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentSepaCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="authorize" xsi:type="string">AdyenPaymentSepaAuthorizeCommand</item>
                <item name="capture" xsi:type="string">AdyenPaymentCaptureCommand</item>
                <item name="void" xsi:type="string">AdyenPaymentCancelCommand</item>
                <item name="refund" xsi:type="string">AdyenPaymentRefundCommand</item>
                <item name="cancel" xsi:type="string">AdyenPaymentCancelCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentBoletoCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="authorize" xsi:type="string">AdyenPaymentBoletoAuthorizeCommand</item>
                <item name="capture" xsi:type="string">AdyenPaymentCaptureCommand</item>
                <item name="void" xsi:type="string">AdyenPaymentCancelCommand</item>
                <item name="refund" xsi:type="string">AdyenPaymentRefundCommand</item>
                <item name="cancel" xsi:type="string">AdyenPaymentCancelCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentPosCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="initialize" xsi:type="string">Adyen\Payment\Gateway\Command\PosCommand</item>
                <item name="capture" xsi:type="string">AdyenPaymentCaptureCommand</item>
                <item name="void" xsi:type="string">AdyenPaymentCancelCommand</item>
                <item name="refund" xsi:type="string">AdyenPaymentRefundCommand</item>
                <item name="cancel" xsi:type="string">AdyenPaymentCancelCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentPayByMailCommandPool" type="Magento\Payment\Gateway\Command\CommandPool">
        <arguments>
            <argument name="commands" xsi:type="array">
                <item name="initialize" xsi:type="string">Adyen\Payment\Gateway\Command\PayByMailCommand</item>
                <item name="capture" xsi:type="string">AdyenPaymentCaptureCommand</item>
                <item name="void" xsi:type="string">AdyenPaymentCancelCommand</item>
                <item name="refund" xsi:type="string">AdyenPaymentRefundCommand</item>
                <item name="cancel" xsi:type="string">AdyenPaymentCancelCommand</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Authorization command  -->
    <virtualType name="AdyenPaymentCcAuthorizeCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AdyenPaymentCcAuthorizeRequest</argument>
            <argument name="transferFactory" xsi:type="object">Adyen\Payment\Gateway\Http\TransferFactory</argument>
            <argument name="client" xsi:type="object">Adyen\Payment\Gateway\Http\Client\TransactionAuthorization</argument>
            <argument name="validator" xsi:type="object">GeneralResponseValidator</argument>
            <argument name="handler" xsi:type="object">AdyenPaymentCcResponseHandlerComposite</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentAuthorize3DCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AdyenPaymentAuthorize3DRequest</argument>
            <argument name="transferFactory" xsi:type="object">Adyen\Payment\Gateway\Http\TransferFactory</argument>
            <argument name="client" xsi:type="object">Adyen\Payment\Gateway\Http\Client\TransactionAuthorization</argument>
            <argument name="validator" xsi:type="object">GeneralResponseValidator</argument>
            <argument name="handler" xsi:type="object">AdyenPaymentCcResponseHandlerComposite</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentOneclickAuthorizeCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AdyenPaymentOneclickAuthorizeRequest</argument>
            <argument name="transferFactory" xsi:type="object">Adyen\Payment\Gateway\Http\TransferFactory</argument>
            <argument name="client" xsi:type="object">Adyen\Payment\Gateway\Http\Client\TransactionAuthorization</argument>
            <argument name="validator" xsi:type="object">GeneralResponseValidator</argument>
            <argument name="handler" xsi:type="object">AdyenPaymentCcResponseHandlerComposite</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentSepaAuthorizeCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AdyenPaymentSepaAuthorizeRequest</argument>
            <argument name="transferFactory" xsi:type="object">Adyen\Payment\Gateway\Http\TransferFactory</argument>
            <argument name="client" xsi:type="object">Adyen\Payment\Gateway\Http\Client\TransactionAuthorization</argument>
            <argument name="validator" xsi:type="object">GeneralResponseValidator</argument>
            <argument name="handler" xsi:type="object">AdyenPaymentSepaResponseHandlerComposite</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentBoletoAuthorizeCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AdyenPaymentBoletoAuthorizeRequest</argument>
            <argument name="transferFactory" xsi:type="object">Adyen\Payment\Gateway\Http\TransferFactory</argument>
            <argument name="client" xsi:type="object">Adyen\Payment\Gateway\Http\Client\TransactionAuthorization</argument>
            <argument name="validator" xsi:type="object">GeneralResponseValidator</argument>
            <argument name="handler" xsi:type="object">AdyenPaymentBoletoResponseHandlerComposite</argument>
        </arguments>
    </virtualType>

    <!-- Capture command  -->
    <virtualType name="AdyenPaymentCaptureCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AdyenPaymentCaptureRequest</argument>
            <argument name="transferFactory" xsi:type="object">Adyen\Payment\Gateway\Http\TransferFactory</argument>
            <argument name="client" xsi:type="object">Adyen\Payment\Gateway\Http\Client\TransactionCapture</argument>
            <argument name="validator" xsi:type="object">Adyen\Payment\Gateway\Validator\CaptureResponseValidator</argument>
            <argument name="handler" xsi:type="object">AdyenPaymentCaptureResponseHandlerComposite</argument>
        </arguments>
    </virtualType>
    <!--Refund command-->
    <virtualType name="AdyenPaymentRefundCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AdyenPaymentRefundRequest</argument>
            <argument name="transferFactory" xsi:type="object">Adyen\Payment\Gateway\Http\TransferFactory</argument>
            <argument name="client" xsi:type="object">Adyen\Payment\Gateway\Http\Client\TransactionRefund</argument>
            <argument name="validator" xsi:type="object">Adyen\Payment\Gateway\Validator\RefundResponseValidator</argument>
            <argument name="handler" xsi:type="object">AdyenPaymentRefundResponseHandlerComposite</argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentCancelCommand" type="Magento\Payment\Gateway\Command\GatewayCommand">
        <arguments>
            <argument name="requestBuilder" xsi:type="object">AdyenPaymentCancelRequest</argument>
            <argument name="transferFactory" xsi:type="object">Adyen\Payment\Gateway\Http\TransferFactory</argument>
            <argument name="client" xsi:type="object">Adyen\Payment\Gateway\Http\Client\TransactionCancel</argument>
            <argument name="validator" xsi:type="object">Adyen\Payment\Gateway\Validator\CancelResponseValidator</argument>
            <argument name="handler" xsi:type="object">AdyenPaymentCancelResponseHandlerComposite</argument>
        </arguments>
    </virtualType>


    <!-- Authorization Request -->
    <virtualType name="AdyenPaymentCcAuthorizeRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="merchantaccount" xsi:type="string">Adyen\Payment\Gateway\Request\MerchantAccountDataBuilder</item>
                <item name="customer" xsi:type="string">Adyen\Payment\Gateway\Request\CustomerDataBuilder</item>
                <item name="customerip" xsi:type="string">Adyen\Payment\Gateway\Request\CustomerIpDataBuilder</item>
                <item name="address" xsi:type="string">Adyen\Payment\Gateway\Request\AddressDataBuilder</item>
                <item name="payment" xsi:type="string">Adyen\Payment\Gateway\Request\PaymentDataBuilder</item>
                <item name="browserinfo" xsi:type="string">Adyen\Payment\Gateway\Request\BrowserInfoDataBuilder</item>
                <item name="recurring" xsi:type="string">Adyen\Payment\Gateway\Request\RecurringDataBuilder</item>
                <item name="transaction" xsi:type="string">Adyen\Payment\Gateway\Request\CcAuthorizationDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentAuthorize3DRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="merchantaccount" xsi:type="string">Adyen\Payment\Gateway\Request\MerchantAccountDataBuilder</item>
                <item name="browserinfo" xsi:type="string">Adyen\Payment\Gateway\Request\BrowserInfoDataBuilder</item>
                <item name="customerip" xsi:type="string">Adyen\Payment\Gateway\Request\CustomerIpDataBuilder</item>
                <item name="3dsecure" xsi:type="string">Adyen\Payment\Gateway\Request\Authorize3DSecureDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>


    <virtualType name="AdyenPaymentOneclickAuthorizeRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="merchantaccount" xsi:type="string">Adyen\Payment\Gateway\Request\MerchantAccountDataBuilder</item>
                <item name="customer" xsi:type="string">Adyen\Payment\Gateway\Request\CustomerDataBuilder</item>
                <item name="customerip" xsi:type="string">Adyen\Payment\Gateway\Request\CustomerIpDataBuilder</item>
                <item name="address" xsi:type="string">Adyen\Payment\Gateway\Request\AddressDataBuilder</item>
                <item name="payment" xsi:type="string">Adyen\Payment\Gateway\Request\PaymentDataBuilder</item>
                <item name="browserinfo" xsi:type="string">Adyen\Payment\Gateway\Request\BrowserInfoDataBuilder</item>
                <item name="recurring" xsi:type="string">Adyen\Payment\Gateway\Request\RecurringDataBuilder</item>
                <item name="transaction" xsi:type="string">Adyen\Payment\Gateway\Request\CcAuthorizationDataBuilder</item>
                <item name="oneclick" xsi:type="string">Adyen\Payment\Gateway\Request\OneclickAuthorizationDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentSepaAuthorizeRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="merchantaccount" xsi:type="string">Adyen\Payment\Gateway\Request\MerchantAccountDataBuilder</item>
                <item name="customer" xsi:type="string">Adyen\Payment\Gateway\Request\CustomerDataBuilder</item>
                <item name="customerip" xsi:type="string">Adyen\Payment\Gateway\Request\CustomerIpDataBuilder</item>
                <item name="address" xsi:type="string">Adyen\Payment\Gateway\Request\AddressDataBuilder</item>
                <item name="payment" xsi:type="string">Adyen\Payment\Gateway\Request\PaymentDataBuilder</item>
                <item name="browserinfo" xsi:type="string">Adyen\Payment\Gateway\Request\BrowserInfoDataBuilder</item>
                <item name="recurring" xsi:type="string">Adyen\Payment\Gateway\Request\RecurringDataBuilder</item>
                <item name="transaction" xsi:type="string">Adyen\Payment\Gateway\Request\SepaAuthorizationDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentBoletoAuthorizeRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="merchantaccount" xsi:type="string">Adyen\Payment\Gateway\Request\MerchantAccountDataBuilder</item>
                <item name="customer" xsi:type="string">Adyen\Payment\Gateway\Request\CustomerDataBuilder</item>
                <item name="customerip" xsi:type="string">Adyen\Payment\Gateway\Request\CustomerIpDataBuilder</item>
                <item name="address" xsi:type="string">Adyen\Payment\Gateway\Request\AddressDataBuilder</item>
                <item name="payment" xsi:type="string">Adyen\Payment\Gateway\Request\PaymentDataBuilder</item>
                <item name="browserinfo" xsi:type="string">Adyen\Payment\Gateway\Request\BrowserInfoDataBuilder</item>
                <item name="recurring" xsi:type="string">Adyen\Payment\Gateway\Request\RecurringDataBuilder</item>
                <item name="transaction" xsi:type="string">Adyen\Payment\Gateway\Request\BoletoAuthorizationDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Capture Request -->
    <virtualType name="AdyenPaymentCaptureRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="merchantaccount" xsi:type="string">Adyen\Payment\Gateway\Request\MerchantAccountDataBuilder</item>
                <item name="capture" xsi:type="string">Adyen\Payment\Gateway\Request\CaptureDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Refund Request -->
    <virtualType name="AdyenPaymentRefundRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <!--<item name="merchantaccount" xsi:type="string">Adyen\Payment\Gateway\Request\MerchantAccountDataBuilder</item>-->
                <item name="refund" xsi:type="string">Adyen\Payment\Gateway\Request\RefundDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>
    <!-- Cancel Request -->
    <virtualType name="AdyenPaymentCancelRequest" type="Magento\Payment\Gateway\Request\BuilderComposite">
        <arguments>
            <argument name="builders" xsi:type="array">
                <item name="merchantaccount" xsi:type="string">Adyen\Payment\Gateway\Request\MerchantAccountDataBuilder</item>
                <item name="cancel" xsi:type="string">Adyen\Payment\Gateway\Request\CancelDataBuilder</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Response handlers -->
    <virtualType name="AdyenPaymentCcResponseHandlerComposite" type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="payment_details" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentAuthorisationDetailsHandler</item>
                <item name="payment_comments" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentCommentHistoryHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentSepaResponseHandlerComposite" type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="payment_details" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentAuthorisationDetailsHandler</item>
                <item name="payment_comments" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentCommentHistoryHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentBoletoResponseHandlerComposite" type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="payment_details" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentAuthorisationDetailsHandler</item>
                <item name="payment_comments" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentCommentHistoryHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentCaptureResponseHandlerComposite" type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="capture" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentCaptureDetailsHandler</item>
                <item name="payment_comments" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentCommentHistoryHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentRefundResponseHandlerComposite" type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="capture" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentRefundDetailsHandler</item>
                <item name="payment_comments" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentCommentHistoryRefundHandler</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPaymentCancelResponseHandlerComposite" type="Magento\Payment\Gateway\Response\HandlerChain">
        <arguments>
            <argument name="handlers" xsi:type="array">
                <item name="cancel" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentCancelDetailsHandler</item>
                <item name="payment_comments" xsi:type="string">Adyen\Payment\Gateway\Response\PaymentCommentHistoryHandler</item>
            </argument>
        </arguments>
    </virtualType>

    <!-- Value validators infrastructure -->
    <virtualType name="AdyenPaymentCcValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="country" xsi:type="string">AdyenCcCountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenCcCountryValidator" type="Magento\Payment\Gateway\Validator\CountryValidator">
        <arguments>
            <argument name="config" xsi:type="object">AdyenPaymentCcConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentOneclickValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="country" xsi:type="string">AdyenOneclickCountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenOneclickCountryValidator" type="Magento\Payment\Gateway\Validator\CountryValidator">
        <arguments>
            <argument name="config" xsi:type="object">AdyenPaymentOneclickConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentHppValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="country" xsi:type="string">AdyenHppCountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenHppCountryValidator" type="Magento\Payment\Gateway\Validator\CountryValidator">
        <arguments>
            <argument name="config" xsi:type="object">AdyenPaymentHppConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentSepaValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="global" xsi:type="string">Adyen\Payment\Gateway\Validator\SepaValidator</item>
                <item name="country" xsi:type="string">AdyenSepaCountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenSepaCountryValidator" type="Magento\Payment\Gateway\Validator\CountryValidator">
        <arguments>
            <argument name="config" xsi:type="object">AdyenPaymentSepaConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentBoletoValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="country" xsi:type="string">AdyenBoletoCountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenBoletoCountryValidator" type="Magento\Payment\Gateway\Validator\CountryValidator">
        <arguments>
            <argument name="config" xsi:type="object">AdyenPaymentBoletoConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentPosValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="country" xsi:type="string">AdyenPosCountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPosCountryValidator" type="Magento\Payment\Gateway\Validator\CountryValidator">
        <arguments>
            <argument name="config" xsi:type="object">AdyenPaymentPosConfig</argument>
        </arguments>
    </virtualType>

    <virtualType name="AdyenPaymentPayByMailValidatorPool" type="Magento\Payment\Gateway\Validator\ValidatorPool">
        <arguments>
            <argument name="validators" xsi:type="array">
                <item name="country" xsi:type="string">AdyenPayByMailCountryValidator</item>
            </argument>
        </arguments>
    </virtualType>
    <virtualType name="AdyenPayByMailCountryValidator" type="Magento\Payment\Gateway\Validator\CountryValidator">
        <arguments>
            <argument name="config" xsi:type="object">AdyenPaymentPayByMailConfig</argument>
        </arguments>
    </virtualType>


    <!--General Response validator-->
    <virtualType name="GeneralResponseValidator" type="Adyen\Payment\Gateway\Validator\GeneralResponseValidator">
        <arguments>
            <argument name="loggerInterface" xsi:type="object">Adyen\Payment\Logger\AdyenLogger</argument>
        </arguments>
    </virtualType>


    <preference for="Magento\Paypal\Model\Billing\Agreement" type="Adyen\Payment\Model\Billing\Agreement" />
    <type name="Adyen\Payment\Logger\Handler\AdyenDebug">
        <arguments>
            <argument name="filesystem" xsi:type="object">Magento\Framework\Filesystem\Driver\File</argument>
        </arguments>
    </type>
    <type name="Adyen\Payment\Logger\Handler\AdyenNotification">
        <arguments>
            <argument name="filesystem" xsi:type="object">Magento\Framework\Filesystem\Driver\File</argument>
        </arguments>
    </type>
    <type name="Adyen\Payment\Logger\Handler\AdyenResult">
        <arguments>
            <argument name="filesystem" xsi:type="object">Magento\Framework\Filesystem\Driver\File</argument>
        </arguments>
    </type>
    <type name="Adyen\Payment\Logger\Handler\AdyenCronjob">
        <arguments>
            <argument name="filesystem" xsi:type="object">Magento\Framework\Filesystem\Driver\File</argument>
        </arguments>
    </type>
    <type name="Adyen\Payment\Logger\Handler\AdyenInfo">
        <arguments>
            <argument name="filesystem" xsi:type="object">Magento\Framework\Filesystem\Driver\File</argument>
        </arguments>
    </type>
    <type name="Adyen\Payment\Logger\Handler\AdyenError">
        <arguments>
            <argument name="filesystem" xsi:type="object">Magento\Framework\Filesystem\Driver\File</argument>
        </arguments>
    </type>
    <type name="Adyen\Payment\Logger\AdyenLogger">
        <arguments>
            <argument name="name" xsi:type="string">AdyenLoggerTest</argument>
            <argument name="handlers"  xsi:type="array">
                <item name="adyenDebug" xsi:type="object">Adyen\Payment\Logger\Handler\AdyenDebug</item>
                <item name="adyenNotification" xsi:type="object">Adyen\Payment\Logger\Handler\AdyenNotification</item>
                <item name="adyenResult" xsi:type="object">Adyen\Payment\Logger\Handler\AdyenResult</item>
                <item name="adyenCronjob" xsi:type="object">Adyen\Payment\Logger\Handler\AdyenCronjob</item>
                <item name="adyenInfo" xsi:type="object">Adyen\Payment\Logger\Handler\AdyenInfo</item>
                <item name="adyenError" xsi:type="object">Adyen\Payment\Logger\Handler\AdyenError</item>
                <item name="system" xsi:type="object">Magento\Framework\Logger\Handler\System</item>
                <item name="debug" xsi:type="object">Magento\Framework\Logger\Handler\Debug</item>
            </argument>
        </arguments>
    </type>
    <type name="Adyen\Payment\Model\Config\Reader">
        <arguments>
            <argument name="fileName" xsi:type="string">adyen_payment.xml</argument>
            <argument name="converter" xsi:type="object">Adyen\Payment\Model\Config\Converter</argument>
            <argument name="schemaLocator" xsi:type="object">Adyen\Payment\Model\Config\SchemaLocator</argument>
        </arguments>
    </type>

    <virtualType name="adyenPaymentConfigDataStorage" type="Magento\Framework\Config\Data">
        <arguments>
            <argument name="reader" xsi:type="object">Adyen\Payment\Model\Config\Reader</argument>
            <argument name="cacheId" xsi:type="string">adyen_payment_config</argument>
        </arguments>
    </virtualType>
    <type name="Adyen\Payment\Helper\Data">
        <arguments>
            <argument name="dataStorage" xsi:type="object">adyenPaymentConfigDataStorage</argument>
        </arguments>
    </type>
    <preference for="Adyen\Payment\Api\GuestAdyenPaymentMethodManagementInterface" type="Adyen\Payment\Model\GuestAdyenPaymentMethodManagement" />
    <preference for="Adyen\Payment\Api\AdyenPaymentMethodManagementInterface" type="Adyen\Payment\Model\AdyenPaymentMethodManagement" />
</config>